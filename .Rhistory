system.file("gpkg/nc.gpkg", package="sf") %>%
read_sf() -> nc
system.file("gpkg/nc.gpkg", package="sf") %>% read_sf() -> nc
nc_file <- system.file("gpkg/nc.gpkg", package="sf")
nc <- read_sf(nc)
library(sf)
library(spatstat)
library(gstat)
library(randomForest)
library(stars)
library(class)
library(ggplot2)
nc_file <- system.file("gpkg/nc.gpkg", package="sf")
nc <- read_sf(nc)
nc <- read_sf(nc_file)
#3) Redo the water-land classification of section Section 7.4.6 using class::knn instead of lda.
tif <- system.file("tif/L7_ETMs.tif", package = "stars")
#tif <- system.file("tif/L7_ETMs.tif", package = "stars") #load tif
(r <- read_stars(tif))
set.seed(100) #set seed
pts <- st_bbox(r) %>% st_as_sfc() %>% st_sample(30, type = "regular") #create 30 regular sampling locations
(e <- st_extract(r, pts)) #extrct values at sampling locations
plot(r[,,,1], reset = FALSE)
st_as_sf(e) %>% st_coordinates() %>% text(col = "red")
rs <- split(r) #create predictors?
trn <- st_extract(rs, pts) #extract values for predictors?
#add labels
trn$cls[c(1, 2, 3, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30)] <- "land"
trn$cls[c(4, 5, 10)] <- "water"
as.data.frame(trn) %>% select(X1, X2, X3, X4, X5, X6) -> tr
as.data.frame(rs) %>% select(X1, X2, X3, X4, X5, X6) -> test
rs$cls = knn(tr, test, trn$cl, k = 5) #classify using knn with k=5
plot(rs["cls"])
#Datacubes
package(gdalcubes)
#Datacubes
gdalcubes
#Datacubes
library(gdalcubes)
#Datacubes
install.packages(gdalcubes)
#Datacubes
install.packages("gdalcubes")
library(gdalcubes)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
gArnsberg <- Gest(pppArnsberg)
#import libraries
library(sf)
#import libraries
library(sf)
library(raster)
library(spatstat)
#import precincts
precincts <- st_read("data/dvg2_EPSG25832_Shape/dvg2rbz_nw.shp")
#union precincts
precinctsUnion <- st_union(precincts)
precinctsCentroids = st_coordinates(st_centroid(st_geometry(precincts)))
text(precinctsCentroids, labels = precincts$GN, col = "blue")
title(main = "Precincts of NRW")
#import potential yields
potentialYields <- raster("data/Energieleistungsdichte-100m_EPSG25832_TIFF/en_100m_klas.tif")
#create subset of wind turbines for each precinct
windTurbinesArnsberg <- st_intersection(windTurbines, precincts[precincts$GN == "Arnsberg",])
#create subset of wind turbines for each precinct
windTurbinesArnsberg <- st_intersection(windTurbines, precincts[precincts$GN == "Arnsberg",])
windTurbinesDetmold <- st_intersection(windTurbines, precincts[precincts$GN == "Detmold",])
#import wind turbines
windTurbines <- st_read("data/OpenEE-Windenergie_EPSG25832_Shape/Windbetrieb_Standorte.shp")
summary(windTurbines)
#import potential yields
potentialYields <- raster("data/Energieleistungsdichte-100m_EPSG25832_TIFF/en_100m_klas.tif")
#create subset of wind turbines for each precinct
windTurbinesArnsberg <- st_intersection(windTurbines, precincts[precincts$GN == "Arnsberg",])
windTurbinesDetmold <- st_intersection(windTurbines, precincts[precincts$GN == "Detmold",])
windTurbinesKöln <- st_intersection(windTurbines, precincts[precincts$GN == "Köln",])
windTurbinesDüsseldorf <- st_intersection(windTurbines, precincts[precincts$GN == "Düsseldorf",])
windTurbinesMünster <- st_intersection(windTurbines, precincts[precincts$GN == "Münster",])
#create planar point patterns from wind turbine subsets
pppArnsberg <- as.ppp(c(st_geometry(precincts[precincts$GN == "Arnsberg",]), st_geometry(windTurbinesArnsberg)))
pppDetmold <- as.ppp(c(st_geometry(precincts[precincts$GN == "Detmold",]), st_geometry(windTurbinesDetmold)))
pppDüsseldorf <- as.ppp(c(st_geometry(precincts[precincts$GN == "Düsseldorf",]), st_geometry(windTurbinesDüsseldorf)))
pppMünster <- as.ppp(c(st_geometry(precincts[precincts$GN == "Münster",]), st_geometry(windTurbinesMünster)))
#compute densities of wind turbines for each precinct
densityArnsberg <- density(pppArnsberg, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
#compute densities of wind turbines for each precinct
densityArnsberg <- density(pppArnsberg, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityDetmold <- density(pppDetmold, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityKöln <- density(pppKöln, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
pppKöln <- as.ppp(c(st_geometry(precincts[precincts$GN == "Köln",]), st_geometry(windTurbinesKöln)))
pppDüsseldorf <- as.ppp(c(st_geometry(precincts[precincts$GN == "Düsseldorf",]), st_geometry(windTurbinesDüsseldorf)))
pppMünster <- as.ppp(c(st_geometry(precincts[precincts$GN == "Münster",]), st_geometry(windTurbinesMünster)))
densityKöln <- density(pppKöln, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityKöln <- density(pppKöln, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityDüsseldorf <- density(pppDüsseldorf, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityMünster <- density(pppMünster, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
gArnsberg <- Gest(pppArnsberg, correction="all")
plot(gArnsberg)
gEnvArnsberg <- envelope(pppArnsberg, fun=Gest, nsim=99)
plot(gArnsberg)
plot(gEnvArnsberg, add = TRUE)
plot(gEnvArnsberg)
plot(gArnsberg)
plot(gEnvArnsberg)
gEnvArnsberg <- envelope(pppArnsberg, fun=Gest, nsim=99, correction="all")
plot(gArnsberg)
plot(gEnvArnsberg)
gEnvArnsberg <- envelope(pppArnsberg, fun=Gest, nsim=99, clipdata = TRUE)
plot(gEnvArnsberg)
gEnvArnsberg <- envelope(pppArnsberg, fun=Gest, nsim=99, clipdata = TRUE, global = TRUE)
plot(gArnsberg)
plot(gEnvArnsberg)
gEnvArnsberg <- envelope(pppArnsberg, fun = Gest, nsim = 99, clipdata = TRUE, correction = "best")
plot(gEnvArnsberg)
fEnvArnsberg <- envelope(pppArnsberg, fun = Fest, nsim = 99, clipdata = TRUE, correction = "best")
plot(fEnvArnsberg)
jEnvArnsberg <- envelope(pppArnsberg, fun = Jest, nsim = 99, clipdata = TRUE, correction = "best")
plot(jEnvArnsberg)
kEnvArnsberg <- envelope(pppArnsberg, fun = Kest, nsim = 99, clipdata = TRUE, correction = "best")
kEnvArnsberg <- envelope(pppArnsberg, fun = Kest, nsim = 99, clipdata = TRUE, correction = "best", nlarge = 3000)
kEnvArnsberg <- envelope(pppArnsberg, fun = Kest, nsim = 99, clipdata = TRUE, correction = "best", nlarge = 100)
lEnvArnsberg <- envelope(pppArnsberg, fun = Lest, nsim = 99, clipdata = TRUE, correction = "best")
par(mfrow=c(1,3))
plot(gEnvArnsberg)
plot(fEnvArnsberg)
plot(jEnvArnsberg)
View(pppArnsberg)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
windTurbineCounts <- c(pppArnsberg$n, pppDetmold$n, pppKöln$n, pppDüsseldorf$n, pppMünster$n)
plot(windTurbineCounts)
plot(windTurbineCounts)
windTurbineCountsDf <- data.frame (WindTurbines=windTurbineCounts, Precints=precintNames)
precintNames <- c(Arnsberg, Detmold, Köln, Düsseldorf, Münster)
windTurbineCounts <- c(pppArnsberg$n, pppDetmold$n, pppKöln$n, pppDüsseldorf$n, pppMünster$n)
windTurbineCountsDf <- data.frame (WindTurbines=windTurbineCounts, Precints=precintNames)
precintNames <- c(Arnsberg, Detmold, Köln, Düsseldorf, Münster)
precintNames <- c("Arnsberg", "Detmold", "Köln", "Düsseldorf", "Münster")
windTurbineCounts <- c(pppArnsberg$n, pppDetmold$n, pppKöln$n, pppDüsseldorf$n, pppMünster$n)
windTurbineCountsDf <- data.frame (WindTurbines=windTurbineCounts, Precints=precintNames)
plot(windTurbineCountsDf)
plot(windTurbineCountsDf, x = WindTurbines, y = Precincts)
plot(windTurbineCountsDf, x = windTurbineCountsDf$WindTurbines, y = windTurbineCountsDf$Precincts)
barplot(windTurbineCountsDf, beside = TRUE, legend = TRUE)
windTurbineCountsDf
windTurbineCountsDf$WindTurbines
barplot(with(windTurbineCountsDf, table(WindTurbines, Precints)), beside = TRUE, legend = TRUE)
barplot(table(windTurbineCountsDf$WindTurbines, windTurbineCountsDf$Precints), beside = TRUE, legend = TRUE)
barplot(table(windTurbineCountsDf$WindTurbines, windTurbineCountsDf$Precints), beside = TRUE, legend = TRUE)
barplot(table(windTurbineCountsDf$WindTurbines), beside = TRUE, legend = TRUE)
barplot(windTurbineCountsDf$WindTurbines, beside = TRUE, legend = TRUE)
barplot(windTurbineCounts,
main = "Maximum Temperatures in a Week",
xlab = "Degree Celsius",
ylab = "Day",
names.arg = windTurbineCounts,
col = "darkred",
horiz = TRUE)
barplot(windTurbineCounts,
main = "Maximum Temperatures in a Week",
xlab = "Degree Celsius",
ylab = "Day",
names.arg = precintNames,
col = "darkred",
horiz = TRUE)
barplot(windTurbineCounts,
main = "Ammount of wind turbines per precinct",
xlab = "Count",
ylab = "Precinct",
names.arg = precintNames)
View(windTurbinesArnsberg)
View(densityKöln)
windTurbineDensities <- c(st_area(precincts[precincts$GN == "Arnsberg",]))
#import libraries
library(sf)
windTurbineDensities <- c(st_area(precincts[precincts$GN == "Arnsberg",]))
windTurbineDensities <- c(st_area(precincts[precincts$GN == "Arnsberg",])/pppArnsberg$n)
windTurbineDensities <- c(pppArnsberg$n/st_area(precincts[precincts$GN == "Arnsberg",]))
windTurbineDensities <- c(pppArnsberg$n/st_area(precincts[precincts$GN == "Arnsberg",]),
pppDetmold$n/st_area(precincts[precincts$GN == "Detmolde",]),
pppKöln$n/st_area(precincts[precincts$GN == "Köln",]),
pppDüsseldorf$n/st_area(precincts[precincts$GN == "Düsseldorf",]),
pppMünster$n/st_area(precincts[precincts$GN == "Münster",]))
barplot(windTurbineDensities, main = "Density of wind turbines per precinct", xlab = "Density", ylab = "Precinct", names.arg = precintNames)
windTurbineDensities <- c(pppArnsberg$n/st_area(precincts[precincts$GN == "Arnsberg",])$area,
pppDetmold$n/st_area(precincts[precincts$GN == "Detmolde",]),
pppKöln$n/st_area(precincts[precincts$GN == "Köln",]),
pppDüsseldorf$n/st_area(precincts[precincts$GN == "Düsseldorf",]),
pppMünster$n/st_area(precincts[precincts$GN == "Münster",]))
windTurbineDensities
windTurbineDensities <- c(pppArnsberg$n/(st_area(precincts[precincts$GN == "Arnsberg",])/1000000),
pppDetmold$n/st_area(precincts[precincts$GN == "Detmolde",]),
pppKöln$n/st_area(precincts[precincts$GN == "Köln",]),
pppDüsseldorf$n/st_area(precincts[precincts$GN == "Düsseldorf",]),
pppMünster$n/st_area(precincts[precincts$GN == "Münster",]))
windTurbineDensities <- c(pppArnsberg$n/(st_area(precincts[precincts$GN == "Arnsberg",])),
pppDetmold$n/st_area(precincts[precincts$GN == "Detmolde",]),
pppKöln$n/st_area(precincts[precincts$GN == "Köln",]),
pppDüsseldorf$n/st_area(precincts[precincts$GN == "Düsseldorf",]),
pppMünster$n/st_area(precincts[precincts$GN == "Münster",]))
windTurbineDensities <- c(pppArnsberg$n/st_area(precincts[precincts$GN == "Arnsberg",])),
windTurbineDensities <- c(pppArnsberg$n/st_area(precincts[precincts$GN == "Arnsberg",]),
pppDetmold$n/st_area(precincts[precincts$GN == "Detmolde",]),
pppKöln$n/st_area(precincts[precincts$GN == "Köln",]),
pppDüsseldorf$n/st_area(precincts[precincts$GN == "Düsseldorf",]),
pppMünster$n/st_area(precincts[precincts$GN == "Münster",]))
windTurbineDensities <- c(pppArnsberg$n/as.numeric(st_area(precincts[precincts$GN == "Arnsberg",])),
pppDetmold$n/st_area(precincts[precincts$GN == "Detmolde",]),
pppKöln$n/st_area(precincts[precincts$GN == "Köln",]),
pppDüsseldorf$n/st_area(precincts[precincts$GN == "Düsseldorf",]),
pppMünster$n/st_area(precincts[precincts$GN == "Münster",]))
windTurbineDensities <- c(pppArnsberg$n/as.numeric(st_area(precincts[precincts$GN == "Arnsberg",])),
pppDetmold$n/st_area(precincts[precincts$GN == "Detmolde",]),
pppKöln$n/st_area(precincts[precincts$GN == "Köln",]),
pppDüsseldorf$n/st_area(precincts[precincts$GN == "Düsseldorf",]),
pppMünster$n/st_area(precincts[precincts$GN == "Münster",]))
windTurbineDensities <- c(pppArnsberg$n/as.numeric(st_area(precincts[precincts$GN == "Arnsberg",])),
pppDetmold$n/as.numeric(st_area(precincts[precincts$GN == "Detmolde",])),
pppKöln$n/as.numeric(st_area(precincts[precincts$GN == "Köln",])),
pppDüsseldorf$n/as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",])),
pppMünster$n/as.numeric(st_area(precincts[precincts$GN == "Münster",])))
barplot(windTurbineDensities, main = "Density of wind turbines per precinct", xlab = "Density", ylab = "Precinct", names.arg = precintNames)
windTurbineDensities <- c(pppArnsberg$n/as.numeric(st_area(precincts[precincts$GN == "Arnsberg",])),
pppDetmold$n/as.numeric(st_area(precincts[precincts$GN == "Detmolde",])),
pppKöln$n/as.numeric(st_area(precincts[precincts$GN == "Köln",])),
pppDüsseldorf$n/as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",])),
pppMünster$n/as.numeric(st_area(precincts[precincts$GN == "Münster",])))
barplot(windTurbineDensities, main = "Density of wind turbines per precinct", xlab = "Density", ylab = "Precinct", names.arg = precintNames)
barplot(windTurbineDensities, main = "Density of wind turbines per precinct", xlab = "Density", ylab = "Precinct", names.arg = precintNames)
windTurbineDensities <- c(pppArnsberg$n/as.numeric(st_area(precincts[precincts$GN == "Arnsberg",])),
pppDetmold$n/as.numeric(st_area(precincts[precincts$GN == "Detmold",])),
pppKöln$n/as.numeric(st_area(precincts[precincts$GN == "Köln",])),
pppDüsseldorf$n/as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",])),
pppMünster$n/as.numeric(st_area(precincts[precincts$GN == "Münster",])))
barplot(windTurbineDensities, main = "Density of wind turbines per precinct", xlab = "Density", ylab = "Precinct", names.arg = precintNames)
windTurbineDensities <- c(pppArnsberg$n/as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
pppDetmold$n/as.numeric(st_area(precincts[precincts$GN == "Detmold",])),
pppKöln$n/as.numeric(st_area(precincts[precincts$GN == "Köln",])),
pppDüsseldorf$n/as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",])),
pppMünster$n/as.numeric(st_area(precincts[precincts$GN == "Münster",])))
barplot(windTurbineDensities, main = "Density of wind turbines per precinct", xlab = "Density", ylab = "Precinct", names.arg = precintNames)
windTurbineDensities <- c(pppArnsberg$n/as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
pppDetmold$n/as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000,
pppKöln$n/as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000,
pppDüsseldorf$n/as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000,
pppMünster$n/as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000)
barplot(windTurbineDensities, main = "Density of wind turbines per precinct", xlab = "Density", ylab = "Precinct", names.arg = precintNames)
windTurbineDensities <- c(pppArnsberg$n/as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
pppDetmold$n/as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000,
pppKöln$n/as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000,
pppDüsseldorf$n/as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000,
pppMünster$n/as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000)
windTurbineDensities <- c(pppArnsberg$n/(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000),
pppDetmold$n/(as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000),
pppKöln$n/(as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000),
pppDüsseldorf$n/(as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000),
pppMünster$n/(as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000))
barplot(windTurbineDensities, main = "Density of wind turbines per precinct", xlab = "Density", ylab = "Precinct", names.arg = precintNames)
precintAreas <- c(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000)
precinctDf <- data.frame(precintNames, precintArea, windTurbineCounts, windTurbineDensities)
precinctDf <- data.frame(precintNames, precintAreas, windTurbineCounts, windTurbineDensities)
precinctTab <- my_table <- tableGrob(precinctDf)
plot(precinctDf)
library(gridExtra)
precinctTab <- my_table <- tableGrob(precinctDf)
plot(precinctTab)
plot(precinctTab, theme = ttheme_minimal())
view(precinctTab)
precinctTab
view(precinctDf)
precinctDf
precinctDf <- data.frame(precintNames as Names, precintAreas, windTurbineCounts, windTurbineDensities)
Names <- c("Arnsberg", "Detmold", "Köln", "Düsseldorf", "Münster")
Counts <- c(pppArnsberg$n, pppDetmold$n, pppKöln$n, pppDüsseldorf$n, pppMünster$n)
Densities <- c(pppArnsberg$n/(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000),
pppDetmold$n/(as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000),
pppKöln$n/(as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000),
pppDüsseldorf$n/(as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000),
pppMünster$n/(as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000))
precinctDf <- data.frame(Names,Areas, Counts, Densities)
Areas <- c(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000)
precinctDf <- data.frame(Names, Areas, Counts, Densities)
precinctDf
precinctDf <- data.frame(precintNames, precintAreas, windTurbineCounts, windTurbineDensities)
colnames(precinctDf) <- c('Precinct','Area in km²','Turbine count', 'Turbine density')
precintNames <- c("Arnsberg", "Detmold", "Köln", "Düsseldorf", "Münster")
windTurbineCounts <- c(pppArnsberg$n, pppDetmold$n, pppKöln$n, pppDüsseldorf$n, pppMünster$n)
windTurbineDensities <- c(pppArnsberg$n/(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000),
pppDetmold$n/(as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000),
pppKöln$n/(as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000),
pppDüsseldorf$n/(as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000),
pppMünster$n/(as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000))
precintAreas <- c(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000)
precinctDf <- data.frame(precintNames, precintAreas, windTurbineCounts, windTurbineDensities)
colnames(precinctDf) <- c('Precinct','Area in km²','Turbine count', 'Turbine density')
precinctDf
show(precinctDf)
par(mar=c(1,1, 1, 1))
plot(st_geometry(precincts[precincts$GN == "Arnsberg",]), main = "Wind turbines - Arnsberg")
plot(st_geometry(windTurbinesArnsberg), pch = 3, col = 'red', add = TRUE)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
summary(potentialYields)
View(densityArnsberg)
potentialYieldsArnsergCropped <- crop(potentialYields, precincts[precincts$GN == "Arnsberg",])
potentialYieldsArnsergMasked <- mask(potentialYieldsArnsergCropped, precincts[precincts$GN == "Arnsberg",])
#import potential yields
potentialYields <- raster("data/Energieleistungsdichte-100m_EPSG25832_TIFF/en_100m_klas.tif")
summary(potentialYields)
plot(potentialYields, col=viridis_pal(option="D")(7))
potentialYieldsArnsergCropped <- crop(potentialYields, precincts[precincts$GN == "Arnsberg",])
potentialYieldsArnsergMasked <- mask(potentialYieldsArnsergCropped, precincts[precincts$GN == "Arnsberg",])
potentialYieldsArnsergMasked$WL_CLASS
potentialYieldsArnsergMasked$WL_CLASS["values"]
min(potentialYieldsArnsergMasked)
potentialYieldsArnsergMasked.from
maxValue(potentialYieldsArnsergMasked)
#plot J-function for precincts
plot(jEnvArnsberg, main = "J-function - Arnsberg", sub = "Fig. ", ylim=c(0,15))
#plot J-function for precincts
plot(jEnvArnsberg, main = "J-function - Arnsberg", sub = "Fig. ", ylim=c(0,15))
#plot J-function for precincts
plot(jEnvArnsberg, main = "J-function - Arnsberg", sub = "Fig. ")
#plot J-function for precincts
plot(jEnvArnsberg, main = "J-function - Arnsberg", sub = "Fig. ")
plot(jEnvDetmold, main = "J-function - Detmold", sub = "Fig. ")
plot(jEnvKöln, main = "J-function - Köln", sub = "Fig. ")
plot(jEnvDüsseldorf, main = "J-function - Düsseldorf", sub = "Fig. ")
#compute G-, F- and J-function for precinct Arnsberg
gEnvArnsberg <- envelope(pppArnsberg, fun = Gest, nsim = 99, clipdata = TRUE, correction = "best", verbose = FALSE)
fEnvArnsberg <- envelope(pppArnsberg, fun = Fest, nsim = 99, clipdata = TRUE, correction = "best", verbose = FALSE)
jEnvArnsberg <- envelope(pppArnsberg, fun = Jest, nsim = 99, clipdata = TRUE, correction = "best", verbose = FALSE)
#import libraries
library(sf)
library(raster)
library(spatstat)
library(spatstat)
library(rasterVis)
library(viridis)
#import libraries
library(sf)
library(raster)
library(spatstat)
library(rasterVis)
library(viridis)
```{r ingestDatasets, include=TRUE}
## Datasets
```{r summarizePrecincts, echo=TRUE, fig.height=8, fig.width=8}
```{r subsetWindTurbines, echo=TRUE}
#create subset of wind turbines for each precinct
windTurbinesArnsberg <- st_intersection(windTurbines, precincts[precincts$GN == "Arnsberg",])
windTurbinesDetmold <- st_intersection(windTurbines, precincts[precincts$GN == "Detmold",])
windTurbinesDetmold <- st_intersection(windTurbines, precincts[precincts$GN == "Detmold",])
windTurbinesKöln <- st_intersection(windTurbines, precincts[precincts$GN == "Köln",])
windTurbinesKöln <- st_intersection(windTurbines, precincts[precincts$GN == "Köln",])
windTurbinesDüsseldorf <- st_intersection(windTurbines, precincts[precincts$GN == "Düsseldorf",])
windTurbinesMünster <- st_intersection(windTurbines, precincts[precincts$GN == "Münster",])
#create planar point patterns from wind turbine subsets
pppArnsberg <- as.ppp(c(st_geometry(precincts[precincts$GN == "Arnsberg",]), st_geometry(windTurbinesArnsberg)))
#create planar point patterns from wind turbine subsets
pppArnsberg <- as.ppp(c(st_geometry(precincts[precincts$GN == "Arnsberg",]), st_geometry(windTurbinesArnsberg)))
pppDetmold <- as.ppp(c(st_geometry(precincts[precincts$GN == "Detmold",]), st_geometry(windTurbinesDetmold)))
pppDetmold <- as.ppp(c(st_geometry(precincts[precincts$GN == "Detmold",]), st_geometry(windTurbinesDetmold)))
pppKöln <- as.ppp(c(st_geometry(precincts[precincts$GN == "Köln",]), st_geometry(windTurbinesKöln)))
pppKöln <- as.ppp(c(st_geometry(precincts[precincts$GN == "Köln",]), st_geometry(windTurbinesKöln)))
pppDüsseldorf <- as.ppp(c(st_geometry(precincts[precincts$GN == "Düsseldorf",]), st_geometry(windTurbinesDüsseldorf)))
pppMünster <- as.ppp(c(st_geometry(precincts[precincts$GN == "Münster",]), st_geometry(windTurbinesMünster)))
pppMünster <- as.ppp(c(st_geometry(precincts[precincts$GN == "Münster",]), st_geometry(windTurbinesMünster)))
precintNames <- c("Arnsberg", "Detmold", "Köln", "Düsseldorf", "Münster")
precintNames <- c("Arnsberg", "Detmold", "Köln", "Düsseldorf", "Münster")
windTurbineCounts <- c(pppArnsberg$n, pppDetmold$n, pppKöln$n, pppDüsseldorf$n, pppMünster$n)
windTurbineCounts <- c(pppArnsberg$n, pppDetmold$n, pppKöln$n, pppDüsseldorf$n, pppMünster$n)
windTurbineDensities <- c(pppArnsberg$n/(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000),
pppDetmold$n/(as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000),
pppKöln$n/(as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000),
pppDüsseldorf$n/(as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000),
pppMünster$n/(as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000))
precintAreas <- c(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000)
windTurbineCounts <- c(pppArnsberg$n, pppDetmold$n, pppKöln$n, pppDüsseldorf$n, pppMünster$n)
windTurbineDensities <- c(pppArnsberg$n/(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000),
pppDetmold$n/(as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000),
pppKöln$n/(as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000),
pppDüsseldorf$n/(as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000),
pppMünster$n/(as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000))
precintAreas <- c(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000)
precinctDf <- data.frame(precintNames, precintAreas, windTurbineCounts, windTurbineDensities)
precinctDf <- data.frame(precintNames, precintAreas, windTurbineCounts, windTurbineDensities)
colnames(precinctDf) <- c('Precinct','Area in km²','Turbine count', 'Turbine density')
windTurbineDensities <- c(pppArnsberg$n/(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000),
pppDetmold$n/(as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000),
pppKöln$n/(as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000),
pppDüsseldorf$n/(as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000),
pppMünster$n/(as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000))
precintAreas <- c(as.numeric(st_area(precincts[precincts$GN == "Arnsberg",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Detmold",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Köln",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Düsseldorf",]))/1000000,
as.numeric(st_area(precincts[precincts$GN == "Münster",]))/1000000)
precinctDf <- data.frame(precintNames, precintAreas, windTurbineCounts, windTurbineDensities)
colnames(precinctDf) <- c('Precinct','Area in km²','Turbine count', 'Turbine density')
#compute densities of wind turbines for each precinct
densityArnsberg <- density(pppArnsberg, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityDetmold <- density(pppDetmold, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityDetmold <- density(pppDetmold, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityKöln <- density(pppKöln, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityDetmold <- density(pppDetmold, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityKöln <- density(pppKöln, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityDüsseldorf <- density(pppDüsseldorf, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
densityMünster <- density(pppMünster, sigma = bw.diggle, diggle = TRUE, edge = TRUE)
```{r plotWindTurbines, echo=FALSE, fig.show='hold', out.width='50%', fig.height=8, message=FALSE}
#plot F-function for precincts
plot(fEnvArnsberg, main = "F-function - Arnsberg", sub = "Fig. ")
#plot J-function for precincts
plot(jEnvArnsberg, main = "J-function - Arnsberg", sub = "Fig. ")
#plot J-function for precincts
plot(jEnvArnsberg, main = "J-function - Arnsberg", sub = "Fig. ", ylim=c(0,15))
#plot J-function for precincts
plot(jEnvArnsberg, main = "J-function - Arnsberg", sub = "Fig. ", ylim=c(0,10))
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
#import libraries
library(sf)
#import libraries
library(sf)
library(raster)
library(spatstat)
library(rasterVis)
library(spatstat)
library(rasterVis)
library(viridis)
#import precincts
precincts <- st_read("data/dvg2_EPSG25832_Shape/dvg2rbz_nw.shp")
#union precincts
precinctsUnion <- st_union(precincts)
#import precincts
precincts <- st_read("data/dvg2_EPSG25832_Shape/dvg2rbz_nw.shp")
#union precincts
precinctsUnion <- st_union(precincts)
summary(precincts)
```{r plotPrecincts, echo=FALSE, fig.height=8, fig.width=8}
precinctsCentroids = st_coordinates(st_centroid(st_geometry(precincts)))
text(precinctsCentroids, labels = precincts$GN, col = "blue")
#plot precincts of NRW
plot(st_geometry(precincts), main = "Precincts of NRW", sub = "Fig. ")
precinctsCentroids = st_coordinates(st_centroid(st_geometry(precincts)))
text(precinctsCentroids, labels = precincts$GN, col = "blue")
```{r summarizeTurbines, echo=TRUE}
#import potential yields
potentialYields <- raster("data/Energieleistungsdichte-100m_EPSG25832_TIFF/en_100m_klas.tif")
#import potential yields
potentialYields <- raster("data/Energieleistungsdichte-100m_EPSG25832_TIFF/en_100m_klas.tif")
summary(potentialYields)
plot(potentialYields, col=viridis_pal(option="D")(7), sub = "Fig. ", main = "Potential yields of NRW")
#plot precincts of NRW
plot(st_geometry(precincts), main = "Precincts of NRW", sub = "Fig. ")
precinctsCentroids = st_coordinates(st_centroid(st_geometry(precincts)))
text(precinctsCentroids, labels = precincts$GN, col = "blue")
potentialYieldsArnsergCropped <- crop(potentialYields, precincts[precincts$GN == "Arnsberg",])
potentialYieldsArnsergMasked <- mask(potentialYieldsArnsergCropped, precincts[precincts$GN == "Arnsberg",])
potentialYieldsDetmoldCropped <- crop(potentialYields, precincts[precincts$GN == "Detmold",])
potentialYieldsDetmoldMasked <- mask(potentialYieldsDetmoldCropped, precincts[precincts$GN == "Detmold",])
potentialYieldsKölnCropped <- crop(potentialYields, precincts[precincts$GN == "Köln",])
potentialYieldsKölnMasked <- mask(potentialYieldsKölnCropped, precincts[precincts$GN == "Köln",])
potentialYieldsDüsseldorfCropped <- crop(potentialYields, precincts[precincts$GN == "Düsseldorf",])
potentialYieldsDüsseldorfMasked <- mask(potentialYieldsDüsseldorfCropped, precincts[precincts$GN == "Düsseldorf",])
potentialYieldsMünsterCropped <- crop(potentialYields, precincts[precincts$GN == "Münster",])
potentialYieldsMünsterMasked <- mask(potentialYieldsMünsterCropped, precincts[precincts$GN == "Münster",])
potentialYieldsArnsergCropped <- crop(potentialYields, precincts[precincts$GN == "Arnsberg",])
potentialYieldsArnsergMasked <- mask(potentialYieldsArnsergCropped, precincts[precincts$GN == "Arnsberg",])
t <- rasterToPolygons(potentialYieldsArnsergMasked, dissolve=TRUE)
